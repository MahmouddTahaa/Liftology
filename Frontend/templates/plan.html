<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Fitness Plan</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Condensed:wght@700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="icon" type="image/x-icon" href="images/weightlifter.png" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Roboto+Condensed:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <!-- Add SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css">
    <style>
      :root {
        /* Light theme */
        --primary: #e60026; /* Bold red */
        --primary-dark: #b3001d;
        --text-primary: #111111;  /* Very dark gray */
        --text-secondary: #444444;
        --bg-primary: #ffffff; /* Pure white */
        --bg-secondary: #f8f9fa;
        --bg-tertiary: #e9ecef;
        --card-bg: #ffffff;
        --border-color: #dee2e6;
        --success: #28a745;
        --warning: #ffc107;
        --darker: #000000;
        --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
        --shadow-md: 0 4px 6px rgba(0,0,0,0.07);
        --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
        --radius-sm: 8px;
        --radius-md: 12px;
        --radius-lg: 16px;
      }

      [data-theme="dark"] {
        /* Dark theme */
        --primary: #ff0033; /* Vivid red for high contrast */
        --primary-dark: #cc0029;
        --text-primary: #ffffff; /* Pure white text */
        --text-secondary: #cccccc;
        --bg-primary: #121212;  /* Deep black background */
        --bg-secondary: #1e1e1e;
        --bg-tertiary: #2d2d2d;
        --card-bg: #1e1e1e;
        --border-color: #333333;
        --darker: #000000;
        --shadow-sm: 0 2px 4px rgba(0,0,0,0.2);
        --shadow-md: 0 4px 6px rgba(0,0,0,0.25);
        --shadow-lg: 0 10px 15px rgba(0,0,0,0.3);
      }

      /* SweetAlert2 Custom Styles */
      .swal2-popup {
        border-radius: var(--radius-lg) !important;
        box-shadow: var(--shadow-lg) !important;
        border: 1px solid var(--border-color) !important;
      }

      .swal2-title {
        color: var(--text-primary) !important;
        font-family: "Montserrat", sans-serif !important;
        font-weight: 600 !important;
      }

      .swal2-content {
        color: var(--text-secondary) !important;
        font-family: "Montserrat", sans-serif !important;
      }

      .swal2-confirm {
        background-color: var(--primary) !important;
        border-radius: var(--radius-md) !important;
        font-family: "Montserrat", sans-serif !important;
        font-weight: 500 !important;
        box-shadow: var(--shadow-sm) !important;
        transition: all 0.3s ease !important;
      }

      .swal2-confirm:hover {
        background-color: var(--primary-dark) !important;
        transform: translateY(-2px) !important;
        box-shadow: var(--shadow-md) !important;
      }

      .swal2-timer-progress-bar {
        background: var(--primary) !important;
      }

      /* Success icon color */
      .swal2-icon.swal2-success {
        border-color: var(--primary) !important;
      }

      .swal2-icon.swal2-success [class^='swal2-success-line'] {
        background-color: var(--primary) !important;
      }

      .swal2-icon.swal2-success .swal2-success-ring {
        border-color: var(--primary) !important;
      }

      /* Error icon color */
      .swal2-icon.swal2-error {
        border-color: var(--primary) !important;
      }

      .swal2-icon.swal2-error [class^='swal2-x-mark-line'] {
        background-color: var(--primary) !important;
      }

      body {
        font-family: "Montserrat", sans-serif;
        background-color: var(--bg-primary);
        color: var(--text-primary);
        line-height: 1.6;
        min-height: 100vh;
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      .container {
        max-width: 1200px;
        padding: 2rem 1rem;
      }

      /* Header Styles */
      .plan-header {
        background: linear-gradient(135deg, rgba(230, 0, 38, 0.05) 0%, var(--card-bg) 100%);
        border-radius: var(--radius-lg);
        padding: 2rem;
        margin-bottom: 3rem;
        box-shadow: var(--shadow-lg);
        border: 1px solid var(--border-color);
        position: relative;
        overflow: hidden;
      }

      .plan-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: linear-gradient(90deg, var(--primary), var(--primary-dark));
      }

      .plan-header h4 {
        font-family: "Roboto Condensed", sans-serif;
        font-weight: 700;
        letter-spacing: 0.5px;
        margin-bottom: 0.75rem;
        color: var(--text-primary);
        font-size: 1.75rem;
      }

      /* Back Link */
      .back-link {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
        font-weight: 600;
        padding: 0.75rem 1.5rem;
        border-radius: 30px;
        transition: all 0.3s ease;
        color: var(--primary);
        background-color: var(--card-bg);
        border: 2px solid var(--primary);
        box-shadow: var(--shadow-sm);
      }

      .back-link:hover {
        background-color: var(--primary);
        color: white;
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      /* Day Card Styles */
      .plan-day {
        background-color: var(--card-bg);
        color: var(--text-primary);
        border: 1px solid var(--border-color);
        padding: 2rem;
        border-radius: var(--radius-lg);
        margin-bottom: 2.5rem;
        box-shadow: var(--shadow-md);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .plan-day:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
        border-color: var(--primary);
      }

      .plan-day h5 {
        font-size: 1.5rem;
        margin-bottom: 1rem;
        color: var(--primary);
        position: relative;
        display: inline-block;
        padding-bottom: 0.5rem;
      }

      .plan-day h5::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 60px;
        height: 3px;
        background-color: var(--primary);
        border-radius: 3px;
      }

      .day-title {
        font-size: 1.1rem;
        color: var(--text-secondary);
        margin-bottom: 2rem;
        font-weight: 500;
      }

      /* Warmup Section */
      .warmup {
        padding: 1.5rem;
        border-radius: var(--radius-md);
        margin-bottom: 2rem;
        background: rgba(230, 0, 38, 0.05);
        border-left: 4px solid var(--primary);
        box-shadow: var(--shadow-sm);
      }

      .warmup strong {
        color: var(--primary);
        font-weight: 600;
        display: block;
        margin-bottom: 0.5rem;
        font-size: 1.1rem;
      }

      /* Exercise Grid */
      .exercise-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 1.5rem;
        margin-top: 1.5rem;
      }

      .exercise-item {
        background-color: var(--card-bg);
        color: var(--text-primary);
        border: 1px solid var(--border-color);
        padding: 1.5rem;
        border-radius: var(--radius-md);
        transition: all 0.3s ease;
        cursor: pointer;
        box-shadow: var(--shadow-sm);
        position: relative;
        overflow: hidden;
      }

      .exercise-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        background-color: var(--primary);
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .exercise-item:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-md);
        border-color: var(--primary);
      }

      .exercise-item:hover::before {
        opacity: 1;
      }

      .exercise-item strong {
        display: block;
        color: var(--text-primary);
        font-weight: 600;
        margin-bottom: 1rem;
        font-size: 1.15rem;
      }

      .exercise-item .exercise-meta {
        display: flex;
        gap: 1rem;
        margin-bottom: 1rem;
        flex-wrap: wrap;
      }

      .exercise-item .meta-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.9rem;
        color: var(--text-secondary);
        background-color: var(--bg-secondary);
        padding: 0.4rem 0.8rem;
        border-radius: 20px;
      }

      .exercise-item .meta-item i {
        color: var(--primary);
        font-size: 0.9rem;
      }

      .exercise-item .view-demo {
        color: var(--primary);
        font-size: 0.9rem;
        margin-top: 1rem;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        transition: color 0.3s ease;
      }

      .exercise-item:hover .view-demo {
        color: var(--primary-dark);
      }

      /* Progress Section */
      .progress-container {
        width: 100%;
        height: 10px;
        background-color: var(--bg-tertiary);
        border-radius: 5px;
        margin: 1rem 0;
        overflow: hidden;
        box-shadow: var(--shadow-sm);
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--primary), var(--primary-dark));
        border-radius: 5px;
        transition: width 0.4s ease;
      }

      /* Modal Styles */
      .exercise-modal .modal-content,
      .replace-exercise-modal .modal-content,
      #motionTrackingModal .modal-content {
        background-color: var(--bg-primary);
        color: var(--text-primary);
        border-radius: var(--radius-lg);
        overflow: hidden;
        border: none;
        box-shadow: var(--shadow-lg);
      }

      .exercise-modal .modal-header,
      .replace-exercise-modal .modal-header,
      #motionTrackingModal .modal-header {
        background-color: var(--bg-primary);
        border-bottom: 1px solid var(--border-color);
        padding: 1.5rem;
      }

      .exercise-modal .modal-body,
      .replace-exercise-modal .modal-body,
      #motionTrackingModal .modal-body {
        background-color: var(--bg-primary);
        color: var(--text-primary);
        padding: 2rem;
      }

      .exercise-modal .modal-footer,
      .replace-exercise-modal .modal-footer,
      #motionTrackingModal .modal-footer {
        background-color: var(--bg-primary);
        border-top: 1px solid var(--border-color);
        padding: 1.5rem;
      }

      [data-theme="dark"] .btn-close {
        filter: invert(1) grayscale(100%) brightness(200%);
      }

      .exercise-modal .modal-title {
        color: var(--primary);
        font-weight: 600;
        font-size: 1.5rem;
      }

      .exercise-video-container {
        position: relative;
        border-radius: var(--radius-md);
        overflow: hidden;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-md);
      }

      .exercise-instructions {
        background: var(--bg-secondary);
        padding: 2rem;
        border-radius: var(--radius-md);
        margin-top: 2rem;
        border-left: 4px solid var(--primary);
        box-shadow: var(--shadow-sm);
      }

      .exercise-instructions h5 {
        color: var(--primary);
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 1.25rem;
      }

      .exercise-targets {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        margin-top: 2rem;
      }

      .exercise-target {
        background: rgba(230, 0, 38, 0.1);
        color: var(--primary);
        padding: 0.6rem 1.2rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 500;
        border: 1px solid rgba(230, 0, 38, 0.2);
        transition: all 0.3s ease;
      }

      .exercise-target:hover {
        background: rgba(230, 0, 38, 0.15);
        transform: translateY(-2px);
      }

      /* Theme Toggle */
      .theme-toggle {
        background: var(--bg-secondary);
        border: none;
        color: var(--text-primary);
        cursor: pointer;
        font-size: 1.25rem;
        padding: 0.75rem;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
      }

      .theme-toggle:hover {
        background-color: var(--primary);
        color: white;
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      /* Responsive Adjustments */
      @media (max-width: 768px) {
        .container {
          padding: 1rem;
        }

        .plan-header {
          padding: 1.5rem;
          margin-bottom: 2rem;
        }

        .plan-header h4 {
          font-size: 1.5rem;
        }

        .exercise-list {
          grid-template-columns: 1fr;
        }

        .exercise-modal .modal-body {
          padding: 1.5rem;
        }

        .theme-toggle {
          position: fixed;
          bottom: 20px;
          right: 20px;
          background-color: var(--primary);
          color: white;
          box-shadow: var(--shadow-md);
          z-index: 1000;
        }
      }

      #progressText {
        color: var(--dark-gray); /* Using improved contrast gray */
      }

      .exercise-modal .modal-body {
        padding: 1.75rem;
        color: var(--dark); /* Force dark text in modal */
      }

      .exercise-video-container {
        position: relative;
        border-radius: 12px;
        overflow: hidden;
        margin-bottom: 1.5rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      }

      .exercise-instructions {
        background: var(--bg-secondary);
        padding: 1.5rem;
        border-radius: 12px;
        margin-top: 1.5rem;
        border-left: 3px solid var(--danger);
      }

      .exercise-instructions h5 {
        color: var(--danger);
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .exercise-instructions h5 i {
        color: var(--danger);
        font-size: 1.2rem;
      }

      .exercise-targets {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 1.5rem;
      }

      .exercise-target {
        background: rgba(244, 67, 54, 0.1);
        color: var(--danger);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
        border: 1px solid rgba(244, 67, 54, 0.2);
      }

      /* Progress Bar */
      .progress-container {
        width: 100%;
        height: 8px;
        background-color: var(--light-gray);
        border-radius: 4px;
        margin: 1rem 0;
        overflow: hidden;
      }

      .progress-bar {
        height: 100%;
        background-color: var(--danger);
        border-radius: 4px;
        transition: width 0.4s ease;
      }

      /* No Plan State */
      .no-plan {
        background: rgba(244, 67, 54, 0.08);
        color: var(--text-primary);
        border-left: 4px solid var(--danger);
        padding: 2rem;
        border-radius: 12px;
        text-align: center;
      }

      .no-plan h5 {
        color: var(--danger);
        font-weight: 600;
        margin-bottom: 1rem;
      }

      /* Modal Styles */
      .exercise-modal .modal-content,
      .replace-exercise-modal .modal-content,
      #motionTrackingModal .modal-content {
        background-color: var(--bg-primary);
        color: var(--text-primary);
        border-radius: 16px;
        overflow: hidden;
        border: none;
        box-shadow: 0 10px 30px rgba(244, 67, 54, 0.1);
      }

      .exercise-modal .modal-header,
      .replace-exercise-modal .modal-header,
      #motionTrackingModal .modal-header {
        background-color: var(--bg-primary);
        border-bottom: 1px solid var(--border-color);
      }

      .exercise-modal .modal-title,
      .replace-exercise-modal .modal-title,
      #motionTrackingModal .modal-title {
        color: var(--danger);
        font-weight: 600;
      }

      .exercise-modal .modal-body,
      .replace-exercise-modal .modal-body,
      #motionTrackingModal .modal-body {
        padding: 1.75rem;
        color: var(--dark); /* Force dark text in modal */
      }

      .exercise-video-container {
        position: relative;
        border-radius: 12px;
        overflow: hidden;
        margin-bottom: 1.5rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      }

      .exercise-instructions {
        background: var(--bg-secondary);
        padding: 1.5rem;
        border-radius: 12px;
        margin-top: 1.5rem;
        border-left: 3px solid var(--danger);
      }

      .exercise-instructions h5 {
        color: var(--danger);
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .exercise-instructions h5 i {
        color: var(--danger);
        font-size: 1.2rem;
      }

      .exercise-targets {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 1.5rem;
      }

      .exercise-target {
        background: rgba(244, 67, 54, 0.1);
        color: var(--danger);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
        border: 1px solid rgba(244, 67, 54, 0.2);
      }

      /* Progress Bar */
      .progress-container {
        width: 100%;
        height: 8px;
        background-color: var(--light-gray);
        border-radius: 4px;
        margin: 1rem 0;
        overflow: hidden;
      }

      .progress-bar {
        height: 100%;
        background-color: var(--danger);
        border-radius: 4px;
        transition: width 0.4s ease;
      }

      /* Responsive Adjustments */
      @media (max-width: 768px) {
        .plan-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .exercise-list {
          grid-template-columns: 1fr;
        }

        .exercise-modal .modal-body {
          padding: 1rem;
        }
      }
      @media (max-width: 768px) {
        .theme-toggle {
          position: fixed;
          bottom: 20px;
          right: 20px;
          background-color: var(--primary);
          color: white;
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
          z-index: 1000;
        }
      }

      /* Replace Exercise Modal Styles */
      .replace-exercise-modal .modal-content {
        background-color: var(--bg-primary);
        border: none;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-lg);
      }

      .replace-exercise-modal .modal-header {
        background: linear-gradient(135deg, rgba(230, 0, 38, 0.05) 0%, var(--card-bg) 100%);
        border-bottom: 1px solid var(--border-color);
        padding: 1.5rem;
      }

      .replace-exercise-modal .modal-title {
        color: var(--primary);
        font-weight: 600;
        font-size: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .replace-exercise-modal .modal-body {
        padding: 2rem;
      }

      .exercise-search-container {
        position: relative;
        margin-bottom: 2rem;
      }

      .exercise-search-container i {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-secondary);
      }

      .exercise-search-input {
        padding-left: 3rem;
        padding-right: 1rem;
        height: 3rem;
        border-radius: var(--radius-md);
        border: 2px solid var(--border-color);
        background-color: var(--bg-secondary);
        color: var(--text-primary);
        transition: all 0.3s ease;
      }

      .exercise-search-input:focus {
        border-color: var(--primary);
        box-shadow: 0 0 0 0.2rem rgba(230, 0, 38, 0.1);
      }

      .current-exercise-card {
        background: linear-gradient(135deg, rgba(230, 0, 38, 0.05) 0%, var(--card-bg) 100%);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        padding: 1.5rem;
        margin-bottom: 2rem;
      }

      .current-exercise-card h6 {
        color: var(--primary);
        margin-bottom: 0.5rem;
        font-weight: 600;
      }

      .exercise-alternatives {
        max-height: 400px;
        overflow-y: auto;
        padding-right: 0.5rem;
      }

      .exercise-alternatives::-webkit-scrollbar {
        width: 8px;
      }

      .exercise-alternatives::-webkit-scrollbar-track {
        background: var(--bg-secondary);
        border-radius: 4px;
      }

      .exercise-alternatives::-webkit-scrollbar-thumb {
        background: var(--primary);
        border-radius: 4px;
      }

      .alternative-exercise-card {
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        padding: 1.25rem;
        margin-bottom: 1rem;
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .alternative-exercise-card:hover {
        transform: translateY(-2px);
        border-color: var(--primary);
        box-shadow: var(--shadow-md);
      }

      .alternative-exercise-card .exercise-name {
        color: var(--text-primary);
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      .alternative-exercise-card .exercise-meta {
        display: flex;
        gap: 1rem;
        color: var(--text-secondary);
        font-size: 0.9rem;
      }

      .alternative-exercise-card .exercise-meta i {
        color: var(--primary);
      }

      .select-exercise-btn {
        background-color: var(--primary);
        color: white;
        border: none;
        padding: 0.5rem 1.25rem;
        border-radius: var(--radius-md);
        font-weight: 500;
        transition: all 0.3s ease;
      }

      .select-exercise-btn:hover {
        background-color: var(--primary-dark);
        transform: translateY(-1px);
      }

      .no-alternatives {
        text-align: center;
        padding: 2rem;
        color: var(--text-secondary);
      }

      .no-alternatives i {
        font-size: 2rem;
        color: var(--primary);
        margin-bottom: 1rem;
      }

      .video-container {
        position: relative;
        width: 100%;
        background: #000;
        border-radius: 8px;
        overflow: hidden;
      }
      
      .video-container img {
        width: 100%;
        height: auto;
        display: block;
      }
      
      .stat-card {
        background: var(--bg-secondary);
        padding: 1.5rem;
        border-radius: 12px;
        text-align: center;
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--border-color);
      }
      
      .stat-card h6 {
        margin-bottom: 0.5rem;
        color: var(--text-secondary);
        font-size: 1rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      
      .stat-card p {
        margin: 0;
        color: var(--primary);
        font-weight: bold;
      }

      .stat-card .display-4 {
        font-size: 3.5rem;
        line-height: 1;
      }

      .stat-card .h4 {
        font-size: 1.5rem;
        margin: 0;
      }

      @media (max-width: 768px) {
        .col-md-4 {
          margin-top: 1rem;
        }
        
        .stat-card {
          padding: 1rem;
        }
        
        .stat-card .display-4 {
          font-size: 2.5rem;
        }
      }

      /* Card Styles */
      .card {
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 16px;
        box-shadow: var(--shadow-sm);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        color: var(--text-primary);
        overflow: hidden;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
        border-color: var(--primary);
      }

      .card-body {
        padding: 1.75rem;
        background-color: var(--card-bg);
      }

      .card h6 {
        color: var(--danger);
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .card p,
      .card small {
        margin-bottom: 0.5rem;
        color: var(--text-primary);
      }

      .card .text-primary {
        color: var(--danger) !important;
      }

      .card .bg-light {
        background-color: var(--bg-secondary) !important;
      }

      .card .border-primary {
        border-color: var(--danger) !important;
      }
    </style>
  </head>
  <body>
    <div class="container py-5">
      <div
        class="plan-header d-flex justify-content-between align-items-center flex-wrap"
      >
        <div>
          <h4>YOUR PERSONALIZED FITNESS PLAN</h4>
          <p class="mb-0">
            Designed specifically for your goals and fitness level
          </p>
        </div>
        <div class="d-flex align-items-center gap-2">
          <button class="theme-toggle" id="themeToggle">
            <i class="fas fa-moon"></i>
          </button>
          <a href="index.html" class="back-link mt-3 mt-md-0"> Home </a>
          <a href="dashboard.html" class="back-link mt-3 mt-md-0"> Dashboard </a>
          <a href="diet.html" class="back-link mt-3 mt-md-0 ms-2"> Diet Plan </a>
        </div>
      </div>

      <div id="output" class="fade-in"></div>

      <!-- Progress Section -->
      <!-- <div class="mt-4 text-center">
        <p class="mb-2">Your weekly progress</p>
        <div class="progress-container">
          <div class="progress-bar" style="width: 0%" id="progressBar"></div>
        </div>
        <small class="" id="progressText">Loading your progress...</small>
      </div>
    </div> -->

    <!-- Exercise Modal -->
    <div
      class="modal fade exercise-modal"
      id="exerciseModal"
      tabindex="-1"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exerciseModalTitle">Exercise Demo</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div id="exerciseContent">
              <div class="text-center py-5">
                <div
                  class="spinner-border text-primary"
                  role="status"
                  style="width: 3rem; height: 3rem"
                >
                  <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3">Loading exercise details...</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Motion Tracking Modal -->
    <div class="modal fade" id="motionTrackingModal" tabindex="-1" aria-labelledby="motionTrackingTitle" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="motionTrackingTitle">Motion Tracking</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-8">
                <div class="video-container mb-3">
                  <img id="videoElement" class="img-fluid" alt="Video feed">
                </div>
              </div>
              <div class="col-md-4">
                <div class="tracking-stats">
                  <div class="stat-card mb-3">
                    <h6>Reps</h6>
                    <p id="repCount" class="display-4">0</p>
                  </div>
                  <div class="stat-card">
                    <h6>Status</h6>
                    <p id="trackingStatus" class="h4">Tracking active</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Add SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
    <script>
      // const formData = JSON.parse(localStorage.getItem("fitnessFormData"));
      // if (formData) {
      //   // Use the form data to personalize the plan
      //   response.name = `${formData.gender === "male" ? "Mr." : "Ms."} User`;
      //   response.goal = "Custom Fitness Plan";
      //   response.level = "Intermediate"; // You can calculate this based on form data
      // }

      //
      document.addEventListener("DOMContentLoaded", async () => {
        const currentUser = JSON.parse(localStorage.getItem("currentUser"));

        if (!currentUser) {
          window.location.href = "signin-signup.html";
          return;
        }
      });

      const currentUser = JSON.parse(localStorage.getItem("currentUser"));
      if (!currentUser) {
        window.location.href = "signin-signup.html";
      }
      // const data = currentUser.fitnessPlan.plan;
      const data = currentUser.exercise_plan.output;

      if (!currentUser || !data) {
        window.location.href = "form.html";
      }
      // Configuration

      // DOM Elements
      const outputEl = document.getElementById("output");
      const exerciseModal = new bootstrap.Modal(
        document.getElementById("exerciseModal")
      );
      const progressBar = document.getElementById("progressBar");
      const progressText = document.getElementById("progressText");

      // Initialize favorites from localStorage
      let favorites = currentUser.favorites || [];

      // Static Exercise Database
      const staticExercises = {
        // Upper Body Exercises
        "bench press": {
          id: 1,
          name: "Barbell Bench Press",
          description:
            "Lie on a flat bench with feet flat on the ground. Grip barbell slightly wider than shoulder-width. Lower bar to chest while keeping elbows at 75° angle. Press bar back up to starting position.",
          category: "Chest",
          equipment: "Barbell, Bench",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Triceps", "Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/04/barbell-bench-press.gif",
        },
        "barbell bench press": {
          id: 2,
          name: "Barbell Bench Press",
          description:
            "Lie on a flat bench with feet flat on the ground. Grip barbell slightly wider than shoulder-width. Lower bar to chest while keeping elbows at 75° angle. Press bar back up to starting position.",
          category: "Chest",
          equipment: "Barbell, Bench",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Triceps", "Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/04/barbell-bench-press.gif",
        },
        "lat pulldowns": {
          id: 3,
          name: "Lat Pulldowns",
          description:
            "Sit at pulldown machine with thighs under pads. Grip bar wider than shoulder-width. Pull bar down to upper chest while leaning back slightly. Return slowly to start position.",
          category: "Back",
          equipment: "Cable Machine",
          muscles: ["Latissimus dorsi"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/08/wide-grip-lat-pulldown.gif",
        },
        "lat pulldown": {
          id: 4,
          name: "Lat Pulldowns",
          description:
            "Sit at pulldown machine with thighs under pads. Grip bar wider than shoulder-width. Pull bar down to upper chest while leaning back slightly. Return slowly to start position.",
          category: "Back",
          equipment: "Cable Machine",
          muscles: ["Latissimus dorsi"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/08/wide-grip-lat-pulldown.gif",
        },
        "lat pulldown assisted if needed": {
          id: 5,
          name: "Lat Pulldowns",
          description:
            "Sit at pulldown machine with thighs under pads. Grip bar wider than shoulder-width. Pull bar down to upper chest while leaning back slightly. Return slowly to start position.",
          category: "Back",
          equipment: "Cable Machine",
          muscles: ["Latissimus dorsi"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/08/wide-grip-lat-pulldown.gif",
        },
        "dumbbell overhead press": {
          id: 6,
          name: "Dumbbell Overhead Press",
          description:
            "Stand or sit holding dumbbells at shoulder level with palms forward. Press weights upward until arms are extended. Lower slowly back to start position.",
          category: "Shoulders",
          equipment: "Dumbbells",
          muscles: ["Deltoids"],
          muscles_secondary: ["Triceps", "Upper chest"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/10/dumbbell-shoulder-press.gif",
        },
        "dumbbell rows": {
          id: 7,
          name: "Dumbbell Rows",
          description:
            "Place one knee and hand on bench, other foot on floor. Hold dumbbell with free hand. Pull weight to hip while keeping elbow close. Lower slowly.",
          category: "Back",
          equipment: "Dumbbells, Bench",
          muscles: ["Latissimus dorsi"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/10/single-arm-dumbbell-row.gif",
        },
        "bicep curls": {
          id: 8,
          name: "Bicep Curls",
          description:
            "Stand holding dumbbells with palms facing forward. Keep elbows close to torso. Curl weights while contracting biceps. Slowly lower back down.",
          category: "Arms",
          equipment: "Dumbbells",
          muscles: ["Biceps brachii"],
          muscles_secondary: ["Brachialis", "Brachioradialis"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/dumbbell-bicep-curl.gif",
        },
        dips: {
          id: 9,
          name: "Dips",
          description:
            "Grip parallel bars with arms straight. Lower body by bending elbows until shoulders are below elbows. Push back up to starting position.",
          category: "Arms",
          equipment: "Dip Station",
          muscles: ["Triceps"],
          muscles_secondary: ["Chest", "Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/08/tricep-dips.gif",
        },
        "dumbbell russian twists": {
          id: 10,
          name: "Dumbbell Russian Twists",
          description:
            "Sit on floor with knees bent, feet elevated. Lean back slightly. Hold dumbbell with both hands and rotate torso side to side, touching weight to floor each side.",
          category: "Core",
          equipment: "Dumbbell",
          muscles: ["Obliques"],
          muscles_secondary: ["Rectus abdominis"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/12/how-to-do-a-kettlebell-russian-twist.gif",
        },
        "dumbbell bench press": {
          id: 11,
          name: "Dumbbell Bench Press",
          description:
            "Lie on flat bench with dumbbells at shoulder level. Press weights up until arms are extended. Lower slowly back to start.",
          category: "Chest",
          equipment: "Dumbbells, Bench",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Triceps", "Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/09/dumbbell-chest-press.gif",
        },
        "dumbbell chest press": {
          id: 12,
          name: "Dumbbell Bench Press",
          description:
            "Lie on flat bench with dumbbells at shoulder level. Press weights up until arms are extended. Lower slowly back to start.",
          category: "Chest",
          equipment: "Dumbbells, Bench",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Triceps", "Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/09/dumbbell-chest-press.gif",
        },
        "barbell rows": {
          id: 13,
          name: "Barbell Rows",
          description:
            "Stand with feet shoulder-width apart, knees slightly bent. Bend at hips until torso is nearly parallel to floor. Hold barbell with overhand grip. Pull weight to lower ribcage, then lower slowly.",
          category: "Back",
          equipment: "Barbell",
          muscles: ["Rhomboids", "Trapezius"],
          muscles_secondary: ["Latissimus dorsi", "Biceps"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/08/yates-row.gif",
        },
        "face pulls": {
          id: 14,
          name: "Face Pulls",
          description:
            "Attach rope to high pulley. Pull rope toward forehead while spreading hands apart. Squeeze shoulder blades together at peak contraction.",
          category: "Shoulders",
          equipment: "Cable Machine",
          muscles: ["Rear deltoids"],
          muscles_secondary: ["Trapezius", "Rotator cuff"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/cable-face-pull.gif",
        },
        "incline dumbbell press": {
          id: 15,
          name: "Incline Dumbbell Press",
          description:
            "Set bench to 30-45° incline. Hold dumbbells at shoulder level with palms forward. Press weights upward until arms are extended. Lower slowly back to start position.",
          category: "Chest",
          equipment: "Dumbbells, Incline Bench",
          muscles: ["Upper pectorals"],
          muscles_secondary: ["Front deltoids", "Triceps"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/09/barbell-incline-bench-press.gif",
        },
        "tricep dips": {
          id: 16,
          name: "Tricep Dips",
          description:
            "Use parallel bars or bench. Lower body by bending elbows to 90 degrees, keeping elbows close to body. Push back up to starting position.",
          category: "Arms",
          equipment: "Dip Station or Bench",
          muscles: ["Triceps"],
          muscles_secondary: ["Chest", "Shoulders"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/08/tricep-dips.gif",
        },
        "lateral raises": {
          id: 17,
          name: "Lateral Raises",
          description:
            "Stand holding dumbbells at sides with palms facing in. Raise arms out to sides until parallel to floor. Lower slowly back to starting position.",
          category: "Shoulders",
          equipment: "Dumbbells",
          muscles: ["Lateral deltoids"],
          muscles_secondary: ["Front deltoids", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/11/cabled-seated-rear-lateral-raise.gif",
        },
        pushups: {
          id: 18,
          name: "Push-ups",
          description:
            "Start in plank position with hands slightly wider than shoulders. Lower body until chest nearly touches floor. Push back up to starting position while maintaining straight body line.",
          category: "Chest",
          equipment: "Body Weight",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Triceps", "Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/push-up.gif",
        },
        "pullups or lat pulldowns": {
          id: 19,
          name: "Push-ups",
          description:
            "Start in plank position with hands slightly wider than shoulders. Lower body until chest nearly touches floor. Push back up to starting position while maintaining straight body line.",
          category: "Chest",
          equipment: "Body Weight",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Triceps", "Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/push-up.gif",
        },
        "pullups or lat pulldown": {
          id: 20,
          name: "Push-ups",
          description:
            "Start in plank position with hands slightly wider than shoulders. Lower body until chest nearly touches floor. Push back up to starting position while maintaining straight body line.",
          category: "Chest",
          equipment: "Body Weight",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Triceps", "Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/push-up.gif",
        },
        "seated rows": {
          id: 21,
          name: "Seated Rows",
          description:
            "Sit at cable machine with feet on platform. Pull handle toward waist while keeping back straight. Slowly return to start.",
          category: "Back",
          equipment: "Cable Machine",
          muscles: ["Latissimus dorsi", "Rhomboids"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2024/01/cable-one-arm-seated-row.gif",
        },
        "hammer curls": {
          id: 22,
          name: "Hammer Curls",
          description:
            "Stand holding dumbbells with palms facing torso. Curl weights while keeping palms facing inward. Slowly lower back to starting position.",
          category: "Arms",
          equipment: "Dumbbells",
          muscles: ["Brachialis"],
          muscles_secondary: ["Biceps", "Brachioradialis"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/04/dumbbell-hammer-curl.gif",
        },
        "cable crunch": {
          id: 23,
          name: "Cable Crunch",
          description:
            "Kneel below high pulley with rope attachment. Flex spine to bring elbows toward knees. Slowly return to starting position.",
          category: "Core",
          equipment: "Cable Machine",
          muscles: ["Rectus abdominis"],
          muscles_secondary: ["Obliques"],
          image:
            "https://fitnessprogramer.com/wp-content/uploads/2021/09/Standing-Cable-Crunch.gif",
        },
        "dumbbell shoulder press": {
          id: 24,
          name: "Dumbbell Shoulder Press",
          description:
            "Sit on bench with dumbbells at shoulder height. Press weights overhead until arms are straight. Lower back to shoulders.",
          category: "Shoulders",
          equipment: "Dumbbells",
          muscles: ["Deltoids"],
          muscles_secondary: ["Triceps", "Upper chest"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/10/dumbbell-shoulder-press.gif",
        },
        "seated dumbbell shoulder press": {
          id: 25,
          name: "Dumbbell Shoulder Press",
          description:
            "Sit on bench with dumbbells at shoulder height. Press weights overhead until arms are straight. Lower back to shoulders.",
          category: "Shoulders",
          equipment: "Dumbbells",
          muscles: ["Deltoids"],
          muscles_secondary: ["Triceps", "Upper chest"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/10/dumbbell-shoulder-press.gif",
        },
        "tricep extensions": {
          id: 26,
          name: "Tricep Extensions",
          description:
            "Stand or sit holding dumbbell overhead with both hands. Lower weight behind head by bending elbows. Extend arms to return to start.",
          category: "Arms",
          equipment: "Dumbbell",
          muscles: ["Triceps"],
          muscles_secondary: [],
          image: "https://media1.tenor.com/m/GRMSvKqfksMAAAAC/triceps.gif",
        },
        "seated dumbbell press": {
          id: 27,
          name: "Seated Dumbbell Press",
          description:
            "Sit on bench with back support. Hold dumbbells at shoulder level. Press weights upward until arms are extended. Lower slowly back to start.",
          category: "Shoulders",
          equipment: "Dumbbells, Bench",
          muscles: ["Deltoids"],
          muscles_secondary: ["Triceps", "Upper chest"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/04/arnold-presses.gif",
        },
        "chest press machine": {
          id: 28,
          name: "Chest Press Machine",
          description:
            "Sit with back against pad. Grip handles at chest level. Push handles forward until arms are extended. Slowly return to start.",
          category: "Chest",
          equipment: "Machine",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Triceps", "Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/05/chest-press-machine.gif",
        },
        "seated row machine": {
          id: 29,
          name: "Seated Row Machine",
          description:
            "Sit with chest against pad. Grip handles and pull toward torso while squeezing shoulder blades. Slowly return to start.",
          category: "Back",
          equipment: "Machine",
          muscles: ["Latissimus dorsi"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://i.pinimg.com/originals/55/cd/24/55cd2413f332f47a7bc96a4e8b82ad36.gif",
        },
        "assisted pullups": {
          id: 30,
          name: "Assisted Pull-ups",
          description:
            "Use assisted pull-up machine or resistance band. Grab bar with palms facing away. Pull yourself up until chin clears bar. Lower with control.",
          category: "Back",
          equipment: "Assisted Pull-up Machine",
          muscles: ["Latissimus dorsi"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/pull-up.gif",
        },
        "chest fly machine": {
          id: 31,
          name: "Pec Deck Machine",
          description:
            "Sit with arms extended to sides. Bring arms together in front of chest in hugging motion. Slowly return to start.",
          category: "Chest",
          equipment: "Machine",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Front deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/07/pec-deck.gif",
        },
        "overhead dumbbell press": {
          id: 32,
          name: "Overhead Dumbbell Press",
          description:
            "Stand or sit holding dumbbells at shoulder level. Press weights upward until arms are extended. Lower slowly back to start.",
          category: "Shoulders",
          equipment: "Dumbbells",
          muscles: ["Deltoids"],
          muscles_secondary: ["Triceps", "Upper chest"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/10/dumbbell-shoulder-press.gif",
        },
        "seated cable rows": {
          id: 33,
          name: "Seated Cable Row",
          description:
            "Sit at cable machine with feet on platform. Pull handle toward waist while keeping back straight. Slowly return to start.",
          category: "Back",
          equipment: "Cable Machine",
          muscles: ["Latissimus dorsi", "Rhomboids"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/09/cable-row.gif",
        },
        "seated cable row": {
          id: 34,
          name: "Seated Cable Row",
          description:
            "Sit at cable machine with feet on platform. Pull handle toward waist while keeping back straight. Slowly return to start.",
          category: "Back",
          equipment: "Cable Machine",
          muscles: ["Latissimus dorsi", "Rhomboids"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/09/cable-row.gif",
        },
        "cable rows": {
          id: 35,
          name: "Seated Cable Row",
          description:
            "Sit at cable machine with feet on platform. Pull handle toward waist while keeping back straight. Slowly return to start.",
          category: "Back",
          equipment: "Cable Machine",
          muscles: ["Latissimus dorsi", "Rhomboids"],
          muscles_secondary: ["Biceps", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/09/cable-row.gif",
        },
        "weighted pushups": {
          id: 36,
          name: "Weighted Push-ups",
          description:
            "Perform push-ups with weight plate on back or weighted vest. Maintain straight body line throughout movement.",
          category: "Chest",
          equipment: "Weight Plate or Vest",
          muscles: ["Pectoralis major"],
          muscles_secondary: ["Triceps", "Front deltoids"],
          image:
            "https://www.kettlebellkings.com/cdn/shop/articles/weighted-push-up.gif?v=1701426793",
        },
        "barbell overhead press": {
          id: 37,
          name: "Barbell Overhead Press",
          description:
            "Stand with feet shoulder-width apart. Hold barbell at shoulder level with hands slightly wider than shoulders. Press weight overhead until arms are fully extended. Lower slowly back to shoulders.",
          category: "Shoulders",
          equipment: "Barbell",
          muscles: ["Deltoids"],
          muscles_secondary: ["Triceps", "Upper chest"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/10/seated-overhead-press.gif",
        },
        "inclined weighted situps": {
          id: 38,
          name: "Inclined Weighted Situps",
          description:
            "Secure feet on inclined bench. Hold weight to chest. Perform sit-up by curling torso up. Slowly lower back down.",
          category: "Core",
          equipment: "Incline Bench, Weight",
          muscles: ["Rectus abdominis"],
          muscles_secondary: ["Hip flexors"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/05/decline-sit-up.gif",
        },
        "bent over rows": {
          id: 39,
          name: "Bent Over Rows",
          description:
            "Stand with feet shoulder-width apart, knees slightly bent. Bend at hips until torso is nearly parallel to floor. Hold barbell with overhand grip. Pull weight to lower ribcage, then lower slowly.",
          category: "Back",
          equipment: "Barbell",
          muscles: ["Rhomboids", "Trapezius"],
          muscles_secondary: ["Latissimus dorsi", "Biceps"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/barbell-row.gif",
        },
        "farmer's carry": {
          id: 40,
          name: "Farmer's Carry",
          description:
            "Hold heavy dumbbells or kettlebells at sides. Walk maintaining upright posture for specified distance.",
          category: "Full Body",
          equipment: "Dumbbells or Kettlebells",
          muscles: ["Forearms", "Traps"],
          muscles_secondary: ["Core", "Shoulders"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/farmers-walk.gif",
        },

        // Lower Body Exercises
        "barbell squats": {
          id: 41,
          name: "Barbell Squats",
          description:
            "Stand with feet shoulder-width apart. Keep chest up and back straight. Lower body by bending hips and knees. Descend until thighs are parallel to floor. Drive through heels to return to start position.",
          category: "Legs",
          equipment: "Barbell",
          muscles: ["Quadriceps", "Gluteus maximus"],
          muscles_secondary: ["Hamstrings", "Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/barbell-full-squat.gif",
        },
        "barbell squat": {
          id: 42,
          name: "Barbell Squats",
          description:
            "Stand with feet shoulder-width apart. Keep chest up and back straight. Lower body by bending hips and knees. Descend until thighs are parallel to floor. Drive through heels to return to start position.",
          category: "Legs",
          equipment: "Barbell",
          muscles: ["Quadriceps", "Gluteus maximus"],
          muscles_secondary: ["Hamstrings", "Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/barbell-full-squat.gif",
        },
        "romanian deadlifts": {
          id: 43,
          name: "Romanian Deadlifts",
          description:
            "Hold barbell with feet hip-width. Hinge at hips while keeping back flat. Lower bar along legs until hamstrings stretch. Return to standing.",
          category: "Legs",
          equipment: "Barbell",
          muscles: ["Hamstrings", "Glutes"],
          muscles_secondary: ["Lower back"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/11/dumbbell-romanian-deadlift.gif",
        },
        "romanian deadlift": {
          id: 44,
          name: "Romanian Deadlifts",
          description:
            "Hold barbell with feet hip-width. Hinge at hips while keeping back flat. Lower bar along legs until hamstrings stretch. Return to standing.",
          category: "Legs",
          equipment: "Barbell",
          muscles: ["Hamstrings", "Glutes"],
          muscles_secondary: ["Lower back"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/11/dumbbell-romanian-deadlift.gif",
        },
        "leg press": {
          id: 45,
          name: "Leg Press",
          description:
            "Sit in machine with feet on platform shoulder-width apart. Lower weight by bending knees to 90 degrees. Press back up without locking knees.",
          category: "Legs",
          equipment: "Leg Press Machine",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/07/leg-extension-toes-inward.gif",
        },
        lunges: {
          id: 46,
          name: "Lunges",
          description:
            "Stand tall with feet hip-width apart. Step forward with one leg and lower hips until both knees are bent at 90°. Push back to starting position. Alternate legs.",
          category: "Legs",
          equipment: "Body Weight or Dumbbells",
          muscles: ["Quadriceps", "Gluteus maximus"],
          muscles_secondary: ["Hamstrings", "Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/08/smith-machine-lunge.gif",
        },
        "calf raises": {
          id: 47,
          name: "Calf Raises",
          description:
            "Stand on edge of step with heels hanging off. Raise up onto toes as high as possible. Lower heels below step level for full stretch.",
          category: "Legs",
          equipment: "Body Weight or Dumbbells",
          muscles: ["Gastrocnemius", "Soleus"],
          muscles_secondary: [],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/03/dumbbell-calf-raise.gif",
        },
        "seated calf raise": {
          id: 48,
          name: "Calf Raises",
          description:
            "Stand on edge of step with heels hanging off. Raise up onto toes as high as possible. Lower heels below step level for full stretch.",
          category: "Legs",
          equipment: "Body Weight or Dumbbells",
          muscles: ["Gastrocnemius", "Soleus"],
          muscles_secondary: [],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/seated-calf-raise.gif",
        },
        deadlifts: {
          id: 49,
          name: "Deadlifts",
          description:
            "Stand with feet hip-width apart. Grip barbell with hands just outside knees. Keep back flat and chest up. Lift bar by driving through heels until standing upright. Lower with control.",
          category: "Legs",
          equipment: "Barbell",
          muscles: ["Gluteus maximus", "Hamstrings"],
          muscles_secondary: ["Erector spinae", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/02/barbell-deadlift-movement.gif",
        },
        "deadlifts light to moderate": {
          id: 50,
          name: "Deadlifts (light to moderate)",
          description:
            "Stand with feet hip-width apart. Grip barbell with hands just outside knees. Keep back flat and chest up. Lift bar by driving through heels until standing upright. Lower with control.",
          category: "Legs",
          equipment: "Barbell",
          muscles: ["Gluteus maximus", "Hamstrings"],
          muscles_secondary: ["Erector spinae", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/02/barbell-deadlift-movement.gif",
        },
        deadlift: {
          id: 51,
          name: "Deadlifts",
          description:
            "Stand with feet hip-width apart. Grip barbell with hands just outside knees. Keep back flat and chest up. Lift bar by driving through heels until standing upright. Lower with control.",
          category: "Legs",
          equipment: "Barbell",
          muscles: ["Gluteus maximus", "Hamstrings"],
          muscles_secondary: ["Erector spinae", "Trapezius"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/02/barbell-deadlift-movement.gif",
        },
        "front squats": {
          id: 52,
          name: "Front Squats",
          description:
            "Hold barbell in front rack position. Keep elbows high. Squat down by bending hips and knees. Keep torso upright. Drive through heels to stand.",
          category: "Legs",
          equipment: "Barbell",
          muscles: ["Quadriceps"],
          muscles_secondary: ["Glutes", "Core"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/09/front-squat.gif",
        },
        "bulgarian split squat": {
          id: 53,
          name: "Bulgarian Split Squat",
          description:
            "Stand facing away from bench, place one foot on bench behind you. Lower until front thigh is parallel to floor. Push back up.",
          category: "Legs",
          equipment: "Bench, Dumbbells",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings", "Core"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/bulgarian-split-spuat.gif",
        },
        "bulgarian split squats": {
          id: 54,
          name: "Bulgarian Split Squat",
          description:
            "Stand facing away from bench, place one foot on bench behind you. Lower until front thigh is parallel to floor. Push back up.",
          category: "Legs",
          equipment: "Bench, Dumbbells",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings", "Core"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/bulgarian-split-spuat.gif",
        },
        "leg curls": {
          id: 55,
          name: "Leg Curls",
          description:
            "Lie face down on machine. Curl legs up by flexing knees. Squeeze hamstrings at top. Slowly lower back to start.",
          category: "Legs",
          equipment: "Machine",
          muscles: ["Hamstrings"],
          muscles_secondary: ["Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/seated-leg-curl.gif",
        },
        "leg curl machine": {
          id: 56,
          name: "Leg Curls",
          description:
            "Lie face down on machine. Curl legs up by flexing knees. Squeeze hamstrings at top. Slowly lower back to start.",
          category: "Legs",
          equipment: "Machine",
          muscles: ["Hamstrings"],
          muscles_secondary: ["Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/seated-leg-curl.gif",
        },
        "leg curl": {
          id: 57,
          name: "Leg Curls",
          description:
            "Lie face down on machine. Curl legs up by flexing knees. Squeeze hamstrings at top. Slowly lower back to start.",
          category: "Legs",
          equipment: "Machine",
          muscles: ["Hamstrings"],
          muscles_secondary: ["Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/seated-leg-curl.gif",
        },
        "glute bridge": {
          id: 58,
          name: "Glute Bridge",
          description:
            "Lie on back with knees bent, feet flat. Lift hips until body forms straight line from shoulders to knees. Squeeze glutes at top.",
          category: "Legs",
          equipment: "Body Weight",
          muscles: ["Glutes"],
          muscles_secondary: ["Hamstrings", "Lower back"],
          image:
            "https://i.pinimg.com/originals/06/24/b5/0624b5b7f2b9cf39108199399e671611.gif",
        },
        "glute bridges": {
          id: 59,
          name: "Glute Bridge",
          description:
            "Lie on back with knees bent, feet flat. Lift hips until body forms straight line from shoulders to knees. Squeeze glutes at top.",
          category: "Legs",
          equipment: "Body Weight",
          muscles: ["Glutes"],
          muscles_secondary: ["Hamstrings", "Lower back"],
          image:
            "https://i.pinimg.com/originals/06/24/b5/0624b5b7f2b9cf39108199399e671611.gif",
        },
        "dumbbell glute bridges": {
          id: 60,
          name: "Glute Bridge",
          description:
            "Lie on back with knees bent, feet flat. Lift hips until body forms straight line from shoulders to knees. Squeeze glutes at top.",
          category: "Legs",
          equipment: "Body Weight",
          muscles: ["Glutes"],
          muscles_secondary: ["Hamstrings", "Lower back"],
          image:
            "https://i.pinimg.com/originals/06/24/b5/0624b5b7f2b9cf39108199399e671611.gif",
        },
        "standing calf raise": {
          id: 61,
          name: "Standing Calf Raise",
          description:
            "Stand on edge of step with heels hanging off. Raise up onto toes as high as possible. Lower heels below step level for full stretch.",
          category: "Legs",
          equipment: "Body Weight or Dumbbells",
          muscles: ["Gastrocnemius", "Soleus"],
          muscles_secondary: [],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/03/dumbbell-calf-raise.gif",
        },
        "goblet squat": {
          id: 62,
          name: "Goblet Squat",
          description:
            "Hold dumbbell or kettlebell at chest. Squat down by bending hips and knees. Keep torso upright. Drive through heels to stand.",
          category: "Legs",
          equipment: "Dumbbell or Kettlebell",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Core"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/08/kettlebell-goblet-squat-muscles.gif",
        },
        "walking lunges": {
          id: 63,
          name: "Walking Lunges",
          description:
            "Stand tall. Step forward into lunge, then bring back foot forward to step into next lunge. Continue alternating legs as you walk forward.",
          category: "Legs",
          equipment: "Body Weight or Dumbbells",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings", "Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/08/bodyweight-walking-lunge-movement.gif",
        },
        "dumbbell lunges": {
          id: 64,
          name: "Dumbbell Lunges",
          description:
            "Hold dumbbells at sides. Step forward into lunge position. Lower until both knees are bent at 90°. Push back to start. Alternate legs.",
          category: "Legs",
          equipment: "Dumbbells",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings", "Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/01/dumbbell-lunges.gif",
        },
        "glute bridge or hip thrust": {
          id: 65,
          name: "Hip Thrust",
          description:
            "Lie on back with knees bent, feet flat. Lift hips until body forms straight line from shoulders to knees. Squeeze glutes at top.",
          category: "Legs",
          equipment: "Body Weight or Barbell",
          muscles: ["Glutes"],
          muscles_secondary: ["Hamstrings", "Lower back"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/09/barbell-hip-thrust.gif",
        },
        "lateral lunges": {
          id: 66,
          name: "Lateral Lunges",
          description:
            "Stand with feet wide. Shift weight to one side, bending knee while keeping other leg straight. Push back to center. Alternate sides.",
          category: "Legs",
          equipment: "Body Weight or Dumbbells",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Adductors"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/08/side-lunge.gif",
        },
        "step-ups": {
          id: 67,
          name: "Step-ups",
          description:
            "Stand facing bench or step. Step one foot onto bench, driving through heel to lift body up. Step back down. Alternate legs.",
          category: "Legs",
          equipment: "Bench or Step",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings", "Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/step-up.gif",
        },
        squats: {
          id: 68,
          name: "Bodyweight or Assisted Squats",
          description:
            "Stand with feet shoulder-width apart. Lower body by bending hips and knees. Keep chest up. Return to standing using support if needed.",
          category: "Legs",
          equipment: "Body Weight or Assistance",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/06/bodyweight-squat.gif",
        },
        "bodyweight or assisted squats": {
          id: 69,
          name: "Bodyweight or Assisted Squats",
          description:
            "Stand with feet shoulder-width apart. Lower body by bending hips and knees. Keep chest up. Return to standing using support if needed.",
          category: "Legs",
          equipment: "Body Weight or Assistance",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/06/bodyweight-squat.gif",
        },
        "leg extensions": {
          id: 70,
          name: "Leg Extensions",
          description:
            "Sit on machine with legs under pad. Extend legs fully to straighten knees. Slowly lower back to start.",
          category: "Legs",
          equipment: "Machine",
          muscles: ["Quadriceps"],
          muscles_secondary: [],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/06/leg-extension-machine.gif",
        },
        "kettlebell deadlifts light": {
          id: 71,
          name: "Kettlebell Deadlifts (Light)",
          description:
            "Stand with feet hip-width apart. Hinge at hips to grip kettlebell. Keep back flat. Stand up by driving through heels.",
          category: "Legs",
          equipment: "Kettlebell",
          muscles: ["Hamstrings", "Glutes"],
          muscles_secondary: ["Lower back"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/12/how-to-kettlebell-deadlift.gif",
        },
        "dumbbell goblet squats": {
          id: 72,
          name: "Dumbbell Goblet Squats",
          description:
            "Hold dumbbell vertically at chest. Squat down by bending hips and knees. Keep torso upright. Drive through heels to stand.",
          category: "Legs",
          equipment: "Dumbbell",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Core"],
          image:
            "https://fitnessprogramer.com/wp-content/uploads/2023/01/Dumbbell-Goblet-Squat.gif",
        },
        "hamstring curls": {
          id: 73,
          name: "Hamstring Curls",
          description:
            "Lie face down on machine. Curl legs up by flexing knees. Squeeze hamstrings at top. Slowly lower back to start.",
          category: "Legs",
          equipment: "Machine",
          muscles: ["Hamstrings"],
          muscles_secondary: ["Calves"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/05/leg-curl-benefits.jpg",
        },

        // Full Body & Functional Exercises
        "kettlebell swings": {
          id: 74,
          name: "Kettlebell Swings",
          description:
            "Hinge at hips with kettlebell between legs. Thrust hips forward to swing bell to chest height. Control descent.",
          category: "Full Body",
          equipment: "Kettlebell",
          muscles: ["Glutes", "Hamstrings"],
          muscles_secondary: ["Shoulders", "Core"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/08/dumbbell-swings.gif",
        },
        "medicine ball slams": {
          id: 75,
          name: "Medicine Ball Slams",
          description:
            "Hold medicine ball overhead. Slam it down forcefully while squatting slightly. Catch ball on bounce.",
          category: "Full Body",
          equipment: "Medicine Ball",
          muscles: ["Full body"],
          muscles_secondary: [],
          image:
            "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRf0MeDPZocEfjK41HqmMw9fjMI1K-tAxkHvc_Y-U5XxwUeKfs-rV4jNrVEjpuWRTQPYYM&usqp=CAU",
        },
        "bodyweight exercises": {
          id: 76,
          name: "Bodyweight Exercises",
          description:
            "Various exercises using only body weight for resistance, such as push-ups, squats, lunges, and planks.",
          category: "Full Body",
          equipment: "None",
          muscles: ["Varies by exercise"],
          muscles_secondary: [],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/04/clapping-push-ups.gif",
        },
        "barbell clean and press": {
          id: 77,
          name: "Barbell Clean and Press",
          description:
            "Start with barbell on floor. Explosively lift bar to shoulders (clean), then press overhead. Lower bar back to floor with control.",
          category: "Full Body",
          equipment: "Barbell",
          muscles: ["Quadriceps", "Deltoids"],
          muscles_secondary: ["Glutes", "Trapezius", "Triceps"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/03/clean-and-press.gif",
        },
        plank: {
          id: 78,
          name: "Plank",
          description:
            "Start in push-up position but rest on forearms. Keep body straight from head to heels. Engage core and hold position without letting hips sag.",
          category: "Core",
          equipment: "Body Weight",
          muscles: ["Rectus abdominis", "Transverse abdominis"],
          muscles_secondary: ["Obliques", "Lower back"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/body-saw-plank.gif",
        },
        "mountain climbers": {
          id: 79,
          name: "Mountain Climbers",
          description:
            "Start in plank position. Alternate driving knees toward chest in running motion while keeping hips stable.",
          category: "Full Body",
          equipment: "None",
          muscles: ["Core", "Hip flexors"],
          muscles_secondary: ["Shoulders"],
          image:
            "https://fitnessprogramer.com/wp-content/uploads/2021/02/Mountain-climber.gif",
        },
        "bicycle crunches": {
          id: 80,
          name: "Bicycle Crunches",
          description:
            "Lie on back with hands behind head. Bring opposite elbow to knee while extending other leg. Alternate sides in pedaling motion.",
          category: "Core",
          equipment: "Body Weight",
          muscles: ["Obliques"],
          muscles_secondary: ["Rectus abdominis"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/01/reverse-crunch.gif",
        },
        "russian twists": {
          id: 81,
          name: "Russian Twists",
          description:
            "Sit on floor with knees bent, feet elevated. Lean back slightly. Hold weight with both hands and rotate torso side to side, touching weight to floor each side.",
          category: "Core",
          equipment: "Medicine Ball or Dumbbell",
          muscles: ["Obliques"],
          muscles_secondary: ["Rectus abdominis"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/12/how-to-do-a-kettlebell-russian-twist.gif",
        },
        "russian twist": {
          id: 82,
          name: "Russian Twists",
          description:
            "Sit on floor with knees bent, feet elevated. Lean back slightly. Hold weight with both hands and rotate torso side to side, touching weight to floor each side.",
          category: "Core",
          equipment: "Medicine Ball or Dumbbell",
          muscles: ["Obliques"],
          muscles_secondary: ["Rectus abdominis"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/12/how-to-do-a-kettlebell-russian-twist.gif",
        },
        "side plank": {
          id: 83,
          name: "Side Plank",
          description:
            "Lie on side with legs straight. Prop up on forearm. Lift hips to form straight line from head to feet. Hold without letting hips drop.",
          category: "Core",
          equipment: "Body Weight",
          muscles: ["Obliques"],
          muscles_secondary: ["Glutes"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/08/side-plank-1024x593.png",
        },
        "side planks": {
          id: 84,
          name: "Side Planks",
          description:
            "Lie on side with legs straight. Prop up on forearm. Lift hips to form straight line from head to feet. Hold without letting hips drop.",
          category: "Core",
          equipment: "Body Weight",
          muscles: ["Obliques"],
          muscles_secondary: ["Glutes"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/08/side-plank-1024x593.png",
        },
        "bird dogs": {
          id: 85,
          name: "Bird Dogs",
          description:
            "On hands and knees, extend opposite arm and leg simultaneously. Keep core engaged and back flat.",
          category: "Core",
          equipment: "Mat",
          muscles: ["Core", "Glutes"],
          muscles_secondary: ["Shoulders"],
          image: "https://menspower.nl/wp-content/uploads/2018/03/bird-dog.gif",
        },
        "yoga or stretching": {
          id: 86,
          name: "Yoga or Stretching",
          description:
            "Various yoga poses or stretching exercises to improve flexibility and mobility.",
          category: "Recovery",
          equipment: "Mat",
          muscles: ["Full body"],
          muscles_secondary: [],
          image:
            "https://media0.giphy.com/media/iAn1Wh7Fdnh6rKg4Tq/200w.gif?cid=6c09b9527ur8i8h4rhd1f9z1tu26xca3g5uxant1uywdbdjz&ep=v1_gifs_search&rid=200w.gif&ct=g",
        },
        "yoga or stretching routine": {
          id: 87,
          name: "Yoga or Stretching",
          description:
            "Various yoga poses or stretching exercises to improve flexibility and mobility.",
          category: "Recovery",
          equipment: "Mat",
          muscles: ["Full body"],
          muscles_secondary: [],
          image:
            "https://media0.giphy.com/media/iAn1Wh7Fdnh6rKg4Tq/200w.gif?cid=6c09b9527ur8i8h4rhd1f9z1tu26xca3g5uxant1uywdbdjz&ep=v1_gifs_search&rid=200w.gif&ct=g",
        },
        "foam rolling": {
          id: 88,
          name: "Foam Rolling",
          description:
            "Use foam roller to apply pressure to muscle groups, helping to release tension and improve mobility.",
          category: "Recovery",
          equipment: "Foam Roller",
          muscles: ["Varies by area"],
          muscles_secondary: [],
          image:
            "https://fitnessprogramer.com/wp-content/uploads/2022/02/Roll-Upper-Back.gif",
        },
        "standing core crunches": {
          id: 89,
          name: "Standing Core Crunches",
          description:
            "Stand with feet shoulder-width apart. Bring knee up while crunching opposite elbow toward knee. Alternate sides.",
          category: "Core",
          equipment: "Body Weight",
          muscles: ["Obliques"],
          muscles_secondary: ["Hip flexors"],
          image:
            "https://i.pinimg.com/originals/bd/5a/56/bd5a56b6af6a654fe9c034e6245f57e4.gif",
        },
        "low plank assisted if needed": {
          id: 90,
          name: "Low Plank (Assisted if needed)",
          description:
            "Modified plank position on forearms with knees on ground if needed. Maintain straight line from shoulders to knees.",
          category: "Core",
          equipment: "Body Weight",
          muscles: ["Rectus abdominis"],
          muscles_secondary: ["Shoulders"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/body-saw-plank.gif",
        },
        "light cycling or walking": {
          id: 91,
          name: "Light Cycling or Walking",
          description:
            "Low-intensity cardiovascular activity for active recovery.",
          category: "Cardio",
          equipment: "Bicycle or None",
          muscles: ["Legs"],
          muscles_secondary: [],
          image:
            "https://fitnessprogramer.com/wp-content/uploads/2022/02/Riding-Outdoor-Bicycle.gif",
        },
        "flexibility and stretching routine": {
          id: 92,
          name: "Flexibility and Stretching Routine",
          description:
            "Series of stretches targeting major muscle groups to improve flexibility and range of motion.",
          category: "Recovery",
          equipment: "Mat",
          muscles: ["Full body"],
          muscles_secondary: [],
          image:
            "https://media0.giphy.com/media/iAn1Wh7Fdnh6rKg4Tq/200w.gif?cid=6c09b9527ur8i8h4rhd1f9z1tu26xca3g5uxant1uywdbdjz&ep=v1_gifs_search&rid=200w.gif&ct=g",
        },
        "seated core twist": {
          id: 93,
          name: "Seated Core Twist",
          description:
            "Sit with knees bent, feet lifted. Hold weight with both hands. Rotate torso side to side while keeping core engaged.",
          category: "Core",
          equipment: "Weight",
          muscles: ["Obliques"],
          muscles_secondary: ["Rectus abdominis"],
          image:
            "https://fitnessprogramer.com/wp-content/uploads/2022/05/Seated-twist.gif",
        },
        "ab wheel rollouts": {
          id: 94,
          name: "Ab Wheel Rollouts",
          description:
            "Kneel holding ab wheel. Roll forward while keeping core tight. Pull back to starting position.",
          category: "Core",
          equipment: "Ab Wheel",
          muscles: ["Rectus abdominis"],
          muscles_secondary: ["Shoulders"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/01/ab-wheel.gif",
        },
        "power cleans": {
          id: 95,
          name: "Power Cleans",
          description:
            "Start with barbell on floor. Explosively lift bar to shoulders in one motion. Catch in partial squat.",
          category: "Full Body",
          equipment: "Barbell",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Shoulders", "Back"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/11/dumbbell-power-clean-animated.gif",
        },
        "dumbbell clean and press": {
          id: 96,
          name: "Dumbbell Clean and Press",
          description:
            "Start with barbell on floor. Explosively lift bar to shoulders in one motion. Catch in partial squat.",
          category: "Full Body",
          equipment: "Barbell",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Shoulders", "Back"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/11/dumbbell-power-clean-animated.gif",
        },
        "cable woodchoppers": {
          id: 97,
          name: "Cable Woodchoppers",
          description:
            "Stand sideways to cable machine. Pull cable diagonally across body from high to low. Alternate sides.",
          category: "Core",
          equipment: "Cable Machine",
          muscles: ["Obliques"],
          muscles_secondary: ["Shoulders"],
          image:
            "https://fitliferegime.com/wp-content/uploads/2022/12/Cable-Wood-Chop.gif",
        },

        // Core & Recovery
        "hanging leg raise": {
          id: 98,
          name: "Hanging Leg Raise",
          description:
            "Hang from pull-up bar. Raise legs until thighs are parallel to floor. Lower with control without swinging.",
          category: "Core",
          equipment: "Pull-up Bar",
          muscles: ["Lower abs"],
          muscles_secondary: ["Hip flexors"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/12/captains-chair-knee-raise.gif",
        },
        "yoga or stretch class": {
          id: 99,
          name: "Yoga or Stretch Class",
          description:
            "Guided yoga or stretching session focusing on flexibility, mobility, and relaxation.",
          category: "Recovery",
          equipment: "Mat",
          muscles: ["Full body"],
          muscles_secondary: [],
          image:
            "https://media0.giphy.com/media/iAn1Wh7Fdnh6rKg4Tq/200w.gif?cid=6c09b9527ur8i8h4rhd1f9z1tu26xca3g5uxant1uywdbdjz&ep=v1_gifs_search&rid=200w.gif&ct=g",
        },
        "breathing and relaxation": {
          id: 100,
          name: "Breathing and Relaxation",
          description:
            "Controlled breathing exercises and relaxation techniques to reduce stress and promote recovery.",
          category: "Recovery",
          equipment: "None",
          muscles: [],
          muscles_secondary: [],
          image:
            "https://media0.giphy.com/media/iAn1Wh7Fdnh6rKg4Tq/200w.gif?cid=6c09b9527ur8i8h4rhd1f9z1tu26xca3g5uxant1uywdbdjz&ep=v1_gifs_search&rid=200w.gif&ct=g",
        },
        "light walk": {
          id: 101,
          name: "Light Walk",
          description: "Gentle walking for active recovery and circulation.",
          category: "Cardio",
          equipment: "None",
          muscles: ["Legs"],
          muscles_secondary: [],
          image:
            "https://media1.giphy.com/media/iXOoi6i2l9PZvCN0zU/200w.gif?cid=6c09b952tu8l2sq0e1wuxmf8j69relxmol6s5y9a00dtr3be&ep=v1_gifs_search&rid=200w.gif&ct=g",
        },
        "rowing or elliptical": {
          id: 102,
          name: "Rowing or Elliptical",
          description:
            "Low-impact cardiovascular exercise using either a rowing machine (full-body motion with emphasis on legs and back) or elliptical trainer (smooth gliding motion with reduced joint impact).",
          category: "Cardio",
          equipment: "Rowing Machine or Elliptical Trainer",
          muscles: ["Full body"],
          muscles_secondary: [],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2021/08/elliptical-muscles.gif",
        },
        "mobility and flexibility": {
          id: 103,
          name: "Mobility and Flexibility",
          description:
            "Series of dynamic and static stretches combined with mobility drills to improve joint range of motion, reduce stiffness, and enhance movement quality.",
          category: "Recovery",
          equipment: "Mat",
          muscles: ["Full body"],
          muscles_secondary: [],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/07/quadriceps-stretch.gif",
        },
        stepups: {
          id: 104,
          name: "Step-ups",
          description:
            "Stand facing bench or step. Step one foot onto bench, driving through heel to lift body up. Step back down. Alternate legs. Can be weighted for increased difficulty.",
          category: "Legs",
          equipment: "Bench or Step, Optional Dumbbells",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings", "Calves", "Core"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/07/weighted-step-up.gif",
        },
        "chest supported row": {
          id: 105,
          name: "Chest Supported Row",
          description:
            "Lie face down on an incline bench with dumbbells in hand. Pull the weights up towards your hips while squeezing your shoulder blades together. Slowly lower back down with control. This variation reduces lower back strain and isolates the back muscles effectively.",
          category: "Back",
          equipment: "Incline Bench, Dumbbells",
          muscles: ["Latissimus dorsi", "Rhomboids"],
          muscles_secondary: ["Biceps", "Trapezius", "Rear deltoids"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2022/10/dumbbell-incline-row.gif",
        },
        "bodyweight lunges assisted if needed": {
          id: 106,
          name: "Bodyweight Lunges (Assisted if needed)",
          description:
            "Stand tall with hands on hips or lightly holding a stable surface for balance if needed. Step forward with one leg and lower your hips until both knees are bent at 90-degree angles. Push back up to starting position. This assisted variation is excellent for beginners or those working on balance.",
          category: "Legs",
          equipment: "Body Weight (Optional: Chair or Wall for support)",
          muscles: ["Quadriceps", "Glutes"],
          muscles_secondary: ["Hamstrings", "Core (for balance)"],
          image:
            "https://www.inspireusafoundation.org/wp-content/uploads/2023/08/split-squat.gif",
        },
      };

      // Utility Functions
      function normalizeExerciseName(name) {
        return name
          .toLowerCase()
          .replace(/[^\w\s]/g, "")
          .replace(/\s+/g, " ")
          .trim();
      }

      function saveFavorites() {
        currentUser.favorites = favorites;
        localStorage.setItem("currentUser", JSON.stringify(currentUser));
      }

      // Exercise Data Handling
      async function getExerciseData(exerciseName) {
        const normalizedKey = normalizeExerciseName(exerciseName);

        if (staticExercises[normalizedKey]) {
          console.log("Using static exercise:", normalizedKey);
          return staticExercises[normalizedKey];
        }

        console.warn(`Exercise "${exerciseName}" not found in static data`);
        return null;
      }

      // Exercise Display Functions
      async function showExerciseDetails(exerciseName) {
        try {
          document.getElementById("exerciseContent").innerHTML =
            loadingTemplate(exerciseName);
          document.getElementById("exerciseModalTitle").textContent =
            exerciseName;
          exerciseModal.show();

          const exercise = await getExerciseData(exerciseName);

          if (!exercise) {
            throw new Error("Exercise not found");
          }

          displayExercise(exercise);
        } catch (error) {
          console.error("Error showing exercise:", error);
          showExerciseError(exerciseName);
        }
      }

      function displayExercise(exercise) {
        const isFavorite = favorites.some((fav) => fav.id == exercise.id);

        document.getElementById("exerciseContent").innerHTML = `
                <div class="row">
                  <div class="col-lg-6">
                    <div class="exercise-video-container">
                      <img src="${exercise.image}" alt="${exercise.name}" class="exercise-video img-fluid">
                    </div>

                    <div class="d-flex flex-wrap gap-3 mt-3">
                      <div class="badge bg-dark border-primary text-white">
                        <i class="fas fa-dumbbell me-1"></i> ${exercise.equipment || "Body Weight"}
                      </div>
                      <div class="badge bg-dark border-secondary text-white">
                        <i class="fas fa-running me-1"></i> ${exercise.category || "General"}
                      </div>
                    </div>

                    <div class="exercise-targets mt-4">
                      <h5><i class="fas fa-bullseye text-danger me-2"></i>Target Muscles</h5>
                      <div class="d-flex flex-wrap gap-2 mt-2 w-100">
                        ${exercise.muscles && exercise.muscles.length > 0
                          ? exercise.muscles
                              .map(
                                (muscle) => `
                                <span class="exercise-target">
                                  <i class="fas fa-muscle me-1"></i> ${muscle}
                                </span>
                              `
                              )
                              .join("")
                          : '<span class="exercise-target">Not specified</span>'}
                      </div>
                    </div>

                    ${exercise.muscles_secondary && exercise.muscles_secondary.length > 0
                      ? `
                        <div class="exercise-targets mt-3">
                          <h5><i class="fas fa-plus-circle text-danger me-2"></i>Secondary Muscles</h5>
                          <div class="d-flex flex-wrap gap-2 mt-2 w-100">
                            ${exercise.muscles_secondary
                              .map(
                                (muscle) => `
                                  <span class="exercise-target">
                                    <i class="fas fa-plus me-1"></i> ${muscle}
                                  </span>
                                `
                              )
                              .join("")}
                          </div>
                        </div>
                      `
                      : ""}
                  </div>

                  <div class="col-lg-6">
                    <div class="exercise-instructions">
                      <h5><i class="fas fa-list-ol text-danger me-2"></i>Instructions</h5>
                      <div class="mt-3">
                        ${exercise.description
                          ? exercise.description
                              .split("\n")
                              .filter((p) => p.trim())
                              .map((p) => `<p>${p}</p>`)
                              .join("")
                          : "<p>No specific instructions available for this exercise.</p>"}
                      </div>
                    </div>

                    <div class="mt-4">
                      <h5><i class="fas fa-lightbulb text-danger me-2"></i>Pro Tips</h5>
                      <ul class="mt-2 ps-3">
                        <li>Maintain proper form throughout the movement</li>
                        <li>Control the weight, don't use momentum</li>
                        <li>Breathe out during the exertion phase</li>
                        <li>Start with lighter weights to perfect form</li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="text-center mt-4">
                  <button class="btn btn-danger me-2"
                          onclick="toggleFavorite('${exercise.id}', '${exercise.name.replace(/'/g, "\\'")}')">
                    <i class="${isFavorite ? "fas" : "far"} fa-bookmark me-1"></i>
                    ${isFavorite ? "Saved" : "Save to Favorites"}
                  </button>
                  <button class="btn btn-outline-danger me-2" onclick="startMotionTracking('${exercise.name}')">
                    <i class="fas fa-video me-1"></i> Track Motion
                  </button>
                  <a href="https://www.youtube.com/results?search_query=${encodeURIComponent(
                    exercise.name + " exercise tutorial"
                  )}"
                     target="_blank" class="btn btn-outline-danger mt-2 mt-lg-0">
                    <i class="fab fa-youtube me-1"></i> Watch Tutorials
                  </a>
                </div>
              `;
      }

      // Favorite Functions
      function toggleFavorite(exerciseId, exerciseName) {
        console.log("Toggling favorite for:", exerciseId, exerciseName);
        console.log("Current favorites:", favorites);

        const index = favorites.findIndex((fav) => fav.id == exerciseId);
        console.log("Found at index:", index);

        if (index === -1) {
          favorites.push({ id: exerciseId, name: exerciseName });
        } else {
          favorites.splice(index, 1);
        }

        // Save using the user-specific key
        saveFavorites();

        if (exerciseModal._isShown) {
          const currentExercise =
            document.getElementById("exerciseModalTitle").textContent;
          showExerciseDetails(currentExercise);
        }
      }

      // Helper functions
      function loadingTemplate(name) {
        return `
                <div class="text-center py-5">
                  <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                  <p class="mt-3">Loading "${name}" details...</p>
                  <div class="progress-container mt-3">
                    <div class="progress-bar" style="width: 70%"></div>
                  </div>
                </div>
              `;
      }

      function showExerciseError(name) {
        const availableExercises = Object.values(staticExercises).slice(0, 5); // Show first 5 as examples

        document.getElementById("exerciseContent").innerHTML = `
          <div class="row">
            <div class="col-lg-6">
              <div class="exercise-video-container">
                <img src="${exercise.image}" alt="${
          exercise.name
        }" class="exercise-video img-fluid">
              </div>

              <div class="d-flex flex-wrap gap-3 mt-3">
                <span class="badge bg-light  border-primary">
                  <i class="fas fa-dumbbell me-1"></i> ${
                    exercise.equipment || "Body Weight"
                  }
                </span>
                <span class="badge bg-light  border-primary">
                  <i class="fas fa-running me-1"></i> ${
                    exercise.category || "General"
                  }
                </span>
              </div>

              <div class="exercise-targets mt-4">
                <h5><i class="fas fa-bullseye text-primary me-2"></i>Target Muscles</h5>
                <div class="d-flex flex-wrap gap-2 mt-2 w-100">
                  ${
                    exercise.muscles && exercise.muscles.length > 0
                      ? exercise.muscles
                          .map(
                            (muscle) => `
                          <span class="exercise-target">
                            <i class="fas fa-muscle me-1"></i> ${muscle}
                          </span>`
                          )
                          .join("")
                      : '<span class="exercise-target">Not specified</span>'
                  }
                </div>
              </div>
              ${
                exercise.muscles_secondary &&
                exercise.muscles_secondary.length > 0
                  ? `
                  <div class="exercise-targets mt-3">
                    <h5><i class="fas fa-plus-circle text-primary me-2"></i>Secondary Muscles</h5>
                    <div class="d-flex flex-wrap gap-2 mt-2 w-100">
                      ${exercise.muscles_secondary
                        .map(
                          (muscle) => `
                          <span class="exercise-target">
                            <i class="fas fa-plus me-1"></i> ${muscle}
                          </span>`
                        )
                        .join("")}
                    </div>
                  </div>`
                  : ""
              }
            </div>

            <div class="col-lg-6">
              <div class="exercise-instructions">
                <h5><i class="fas fa-list-ol text-primary me-2"></i>Instructions</h5>
                <div class="mt-3">
                  ${
                    exercise.description
                      ? exercise.description
                          .split("\n")
                          .filter((p) => p.trim())
                          .map((p) => `<p>${p}</p>`)
                          .join("")
                      : "<p>No specific instructions available.</p>"
                  }
                </div>
              </div>

              <div class="mt-4">
                <h5><i class="fas fa-lightbulb text-primary me-2"></i>Pro Tips</h5>
                <ul class="mt-2 ps-3">
                  <li>Maintain proper form throughout</li>
                  <li>Control the weight, don't use momentum</li>
                  <li>Breathe out during exertion</li>
                  <li>Start light to perfect form</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="text-center mt-4">
            <button class="btn ${"btn-danger"} me-2" onclick="toggleFavorite('${
          exercise.id
        }', '${exercise.name.replace(/'/g, "\\'")}')">
              <i class="${isFavorite ? "fas" : "far"} fa-bookmark me-1"></i>
              ${isFavorite ? "Saved" : "Save to Favorites"}
            </button>
            <a href="https://www.youtube.com/results?search_query=${encodeURIComponent(
              exercise.name + " exercise tutorial"
            )}"
               target="_blank" class="btn btn-outline-danger">
              <i class="fab fa-youtube me-1"></i> Watch Tutorials
            </a>
          </div>
        `;
      }

      // Initial Page Load

      // Simulate progress loading
      setTimeout(() => {
        progressBar.style.width = "65%";
        progressText.textContent = "65% complete - 3/5 workouts this week";
      }, 1000);

      if (!data || !data.plan) {
        outputEl.innerHTML = `
                <div class="no-plan">
                  <div class="d-flex align-items-center gap-3 mb-3">
                    <i class="fas fa-exclamation-circle fa-2x"></i>
                    <h5 class="mb-0">No Fitness Plan Found</h5>
                  </div>
                  <p class="mb-4">We couldn't find a personalized fitness plan in your browser storage.</p>
                  <div class="d-flex gap-3 justify-content-center">
                    <a href="index.html" class="btn btn-danger">
                      <i class="fas fa-arrow-left me-2"></i> Create New Plan
                    </a>
                    <button class="btn btn-outline-light" onclick="location.reload()">
                      <i class="fas fa-sync-alt me-2"></i> Try Again
                    </button>
                  </div>
                </div>
              `;
      } else {
        // Display user summary
        // In the display code where you show the user summary
        outputEl.innerHTML += `
        <div class="card border-danger mb-4" style="background-color: var(--card-bg);">
          <div class="card-body" style="text-transform: capitalize;">
            <div class="row">
              <div class="col-md-4">
                <h6 class="text-danger"><i class="fas fa-user me-2"></i> User</h6>
                <p class="mb-2 ps-3" style="color: var(--text-primary);">${currentUser.user_info["first name"] || "Not specified"}</p>
              </div>
              <div class="col-md-4">
                <h6 class="text-danger"><i class="fas fa-bullseye me-2"></i> Goal</h6>
                <p class="mb-2 ps-3" style="color: var(--text-primary);">${currentUser.exercise_plan.input["fitnessGoal"].replace(/_/g, " ") || "Not specified"}</p>
              </div>
              <div class="col-md-4">
                <h6 class="text-danger"><i class="fa-solid fa-weight-scale"></i> Current Weight</h6>
                <p class="mb-2 ps-3" style="color: var(--text-primary);">${currentUser.exercise_plan.input["weight"] || "Not specified"} KG</p>
              </div>
            </div>
          </div>
        </div>
      `;

        // Generate workout days
        for (const [dayKey, dayValue] of Object.entries(data.plan)) {
          const warmup = `
                  <div class="warmup">
                    <strong>Warm-up (${
                      dayValue.warmup.duration | 5
                    } mins)</strong>
                    <p class="mb-0">${dayValue.warmup.exercises.join(", ")}</p>
                  </div>
                `;

          const exercises = Object.entries(dayValue)
            .filter(([k]) => !isNaN(k))
            .map(
              ([_, ex]) => `
                      <div class="exercise-item" onclick="showExerciseDetails('${
                        ex.exercise
                      }')">
                        <strong>${ex.exercise}</strong>
                        <div class="exercise-meta">
                          <span class="meta-item">
                            <i class="fas fa-layer-group"></i> ${ex.sets} sets
                          </span>
                          <span class="meta-item">
                            <i class="fas fa-redo"></i> ${ex.reps} reps
                          </span>
                          ${
                            ex.rest
                              ? `
                            <span class="meta-item">
                              <i class="fas fa-clock"></i> ${ex.rest} rest
                            </span>`
                              : ""
                          }
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                          <div class="view-demo">
                            <i class="fas fa-play-circle"></i> View demonstration
                          </div>
                          <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); showReplaceExerciseModal('${ex.exercise}', '${dayKey}', ${parseInt(Object.keys(dayValue).find(k => !isNaN(k) && dayValue[k].exercise === ex.exercise))})">
                            <i class="fas fa-exchange-alt"></i> Replace
                          </button>
                        </div>
                      </div>
                    `
            )
            .join("");

          outputEl.innerHTML += `
                  <div class="plan-day">
                    <h5>${dayKey.replace(/-/g, " ").toUpperCase()}</h5>
                    <div class="day-title">${dayValue.title}</div>
                    ${warmup}
                    <div class="exercise-list">${exercises}</div>
                  </div>
                `;
        }
      }

      // Make functions available globally
      window.showExerciseDetails = showExerciseDetails;
      window.toggleFavorite = toggleFavorite;
      window.startMotionTracking = startMotionTracking;
      const themeToggle = document.getElementById("themeToggle");
      const prefersDarkScheme = window.matchMedia(
        "(prefers-color-scheme: dark)"
      );

      // Check for saved theme preference or use system preference
      const currentTheme =
        localStorage.getItem("theme") ||
        (prefersDarkScheme.matches ? "dark" : "light");

      // Apply the current theme
      if (currentTheme === "dark") {
        document.documentElement.setAttribute("data-theme", "dark");
        themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
      } else {
        document.documentElement.removeAttribute("data-theme");
        themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
      }

      // Toggle theme on button click
      themeToggle.addEventListener("click", () => {
        let theme;
        if (document.documentElement.getAttribute("data-theme")) {
          document.documentElement.removeAttribute("data-theme");
          theme = "light";
          themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
        } else {
          document.documentElement.setAttribute("data-theme", "dark");
          theme = "dark";
          themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
        }
        localStorage.setItem("theme", theme);
      });

      // Listen for system theme changes
      prefersDarkScheme.addEventListener("change", (e) => {
        if (!localStorage.getItem("theme")) {
          if (e.matches) {
            document.documentElement.setAttribute("data-theme", "dark");
            themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
          } else {
            document.documentElement.removeAttribute("data-theme");
            themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
          }
        }
      });

      // Motion Tracking Functions
      let motionTrackingModal;
      let videoStream;
      let statsInterval;

      function startMotionTracking(exerciseName) {
        if (!motionTrackingModal) {
          motionTrackingModal = new bootstrap.Modal(document.getElementById('motionTrackingModal'));
        }
        
        document.getElementById('motionTrackingTitle').textContent = `Motion Tracking - ${exerciseName}`;
        motionTrackingModal.show();
        
        // Reset tracking stats
        resetTrackingStats();
        
        // Start video feed from Flask service
        const videoElement = document.getElementById('videoElement');
        videoElement.onerror = function() {
          console.error('Error loading video feed');
          document.getElementById('trackingStatus').textContent = 'Error: Could not connect to motion tracking service';
        };
        
        videoElement.src = `http://localhost:8000/video_feed/${encodeURIComponent(exerciseName)}`;
        
        // Start polling for stats immediately
        if (statsInterval) {
          clearInterval(statsInterval);
        }
        statsInterval = setInterval(updateStats, 100); // Update more frequently
      }

      async function resetTrackingStats() {
        try {
          const response = await fetch('http://localhost:8000/reset_stats');
          if (!response.ok) {
            throw new Error('Failed to reset stats');
          }
          document.getElementById('repCount').textContent = '0';
          document.getElementById('trackingStatus').textContent = 'Tracking active';
          console.log('Stats reset successfully');
        } catch (error) {
          console.error('Error resetting stats:', error);
          document.getElementById('trackingStatus').textContent = 'Error: Could not connect to motion tracking service';
        }
      }

      async function updateStats() {
        try {
          const response = await fetch('http://localhost:8000/get_stats');
          if (!response.ok) {
            throw new Error('Failed to fetch stats');
          }
          const data = await response.json();
          
          document.getElementById('repCount').textContent = data.reps;
          document.getElementById('trackingStatus').textContent = `Status: ${data.status}`;
          
          console.log('Stats updated:', data);
        } catch (error) {
          console.error('Error fetching stats:', error);
          document.getElementById('trackingStatus').textContent = 'Error: Lost connection to motion tracking service';
          
          if (statsInterval) {
            clearInterval(statsInterval);
          }
        }
      }

      // Clean up when modal is closed
      document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('motionTrackingModal').addEventListener('hidden.bs.modal', function() {
          if (videoStream) {
            videoStream.getTracks().forEach(track => track.stop());
          }
          if (statsInterval) {
            clearInterval(statsInterval);
          }
          
          // Reset video element
          const videoElement = document.getElementById('videoElement');
          videoElement.src = '';
          
          // Reset stats display
          document.getElementById('repCount').textContent = '0';
          document.getElementById('trackingStatus').textContent = 'Tracking active';
        });
      });
    </script>

    <!-- Replace Exercise Modal -->
    <div class="modal fade replace-exercise-modal" id="replaceExerciseModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              <i class="fas fa-exchange-alt"></i>
              Replace Exercise
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="current-exercise-card">
              <h6>Current Exercise</h6>
              <div class="exercise-name" id="currentExercise"></div>
            </div>
            
            <div class="exercise-search-container">
              <i class="fas fa-search"></i>
              <input type="text" class="form-control exercise-search-input" id="exerciseSearch" placeholder="Search for alternative exercises...">
            </div>
            
            <div class="exercise-alternatives">
              <!-- Alternatives will be populated here -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
    // Add these functions to your existing JavaScript

    let replaceExerciseModal;
    let currentDayKey;
    let currentExerciseIndex;

    function showReplaceExerciseModal(exerciseName, dayKey, exerciseIndex) {
      if (!replaceExerciseModal) {
        replaceExerciseModal = new bootstrap.Modal(document.getElementById('replaceExerciseModal'));
      }
      
      currentDayKey = dayKey;
      currentExerciseIndex = exerciseIndex;
      
      document.getElementById('currentExercise').textContent = exerciseName;
      document.getElementById('exerciseSearch').value = '';
      
      // Get current exercise category
      const currentExercise = staticExercises[normalizeExerciseName(exerciseName)];
      const category = currentExercise ? currentExercise.category : '';
      
      // Filter and display alternatives
      displayExerciseAlternatives(category);
      
      replaceExerciseModal.show();
    }

    function displayExerciseAlternatives(category) {
      const alternativesContainer = document.querySelector('.exercise-alternatives');
      const searchTerm = document.getElementById('exerciseSearch').value.toLowerCase();
      
      // Get unique exercises by name to avoid duplicates
      const uniqueExercises = new Map();
      Object.entries(staticExercises).forEach(([key, exercise]) => {
        if (!uniqueExercises.has(exercise.name)) {
          uniqueExercises.set(exercise.name, exercise);
        }
      });
      
      // Filter exercises based on category and search term
      const filteredExercises = Array.from(uniqueExercises.values())
        .filter(exercise => {
          const matchesSearch = exercise.name.toLowerCase().includes(searchTerm);
          const matchesCategory = !category || exercise.category === category;
          return matchesSearch && matchesCategory;
        });
      
      if (filteredExercises.length === 0) {
        alternativesContainer.innerHTML = `
          <div class="no-alternatives">
            <i class="fas fa-search"></i>
            <p>No matching exercises found</p>
            <small>Try adjusting your search or category filter</small>
          </div>
        `;
        return;
      }
      
      // Display alternatives
      alternativesContainer.innerHTML = filteredExercises.map(exercise => `
        <div class="alternative-exercise-card" onclick="replaceExercise('${exercise.name}')">
          <div class="exercise-name">${exercise.name}</div>
          <div class="exercise-meta">
            <span><i class="fas fa-dumbbell"></i> ${exercise.equipment || 'Body Weight'}</span>
            <span><i class="fas fa-running"></i> ${exercise.category || 'General'}</span>
          </div>
        </div>
      `).join('');
    }

    async function replaceExercise(newExerciseName) {
      try {
        // Get current user's email
        const email = currentUser.user_info.email;
        
        // Make API call to update exercise in database
        const response = await fetch(`https://liftologybackend-production.up.railway.app/exercise-plan/${email}/${currentDayKey}/${currentExerciseIndex}`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            exercise: newExerciseName,
            sets: currentUser.exercise_plan.output.plan[currentDayKey][currentExerciseIndex].sets,
            reps: currentUser.exercise_plan.output.plan[currentDayKey][currentExerciseIndex].reps
          })
        });

        if (!response.ok) {
          throw new Error('Failed to update exercise in database');
        }

        // Update the plan in the current user's data
        const plan = currentUser.exercise_plan.output.plan;
        plan[currentDayKey][currentExerciseIndex].exercise = newExerciseName;
        
        // Save the updated plan
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        // Close the modal
        replaceExerciseModal.hide();
        
        // Show success message using SweetAlert2
        await Swal.fire({
          title: 'Success!',
          text: 'Exercise updated successfully!',
          icon: 'success',
          confirmButtonColor: 'var(--primary)',
          background: 'var(--card-bg)',
          color: 'var(--text-primary)',
          iconColor: 'var(--primary)',
          timer: 2000,
          timerProgressBar: true,
          customClass: {
            popup: 'swal2-popup',
            title: 'swal2-title',
            content: 'swal2-content',
            confirmButton: 'swal2-confirm'
          }
        });
        
        // Refresh the page to show updated plan
        location.reload();
      } catch (error) {
        console.error('Error updating exercise:', error);
        // Show error message using SweetAlert2
        await Swal.fire({
          title: 'Error!',
          text: 'Failed to update exercise. Please try again.',
          icon: 'error',
          confirmButtonColor: 'var(--primary)',
          background: 'var(--card-bg)',
          color: 'var(--text-primary)',
          iconColor: 'var(--primary)',
          customClass: {
            popup: 'swal2-popup',
            title: 'swal2-title',
            content: 'swal2-content',
            confirmButton: 'swal2-confirm'
          }
        });
      }
    }

    // Add event listener for exercise search
    document.getElementById('exerciseSearch').addEventListener('input', function(e) {
      const currentExercise = staticExercises[normalizeExerciseName(document.getElementById('currentExercise').value)];
      displayExerciseAlternatives(currentExercise ? currentExercise.category : '');
    });
    </script>
  </body>
</html>
